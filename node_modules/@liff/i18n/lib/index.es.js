import{__extends as t,__awaiter as n,__generator as e}from"tslib";import{LiffModule as i}from"@liff/use";import{INIT_FAILED as r}from"@liff/consts";import{createLiffError as o}from"@liff/util";import{fetch as s}from"@liff/server-api";var a=navigator.language,c=null;function u(t){return n(this,void 0,void 0,(function(){return e(this,(function(n){switch(n.label){case 0:return a=t,[4,l()];case 1:return n.sent(),[2]}}))}))}function l(){return n(this,void 0,void 0,(function(){var t,n;return e(this,(function(e){switch(e.label){case 0:return[4,s("".concat("https://liffsdk.line-scdn.net/xlt/manifest.json"),{method:"GET",headers:{Accept:"application/json"}})];case 1:return t=e.sent(),n="".concat(a),!t.languages[n]&&a.includes("-")&&(n=a.split("-")[0]),t.languages[n]||(n="en"),[4,s("".concat("https://liffsdk.line-scdn.net/xlt","/").concat(t.languages[n]),{method:"GET",headers:{Accept:"application/json"}})];case 2:return c=e.sent(),[2]}}))}))}function f(t){if(null===c)throw o(r,"please call xlt after liff.init");return c[t]}var p=function(i){function r(){return null!==i&&i.apply(this,arguments)||this}return t(r,i),Object.defineProperty(r.prototype,"name",{get:function(){return"i18n"},enumerable:!1,configurable:!0}),r.prototype.install=function(t){return t.internalHooks.init.beforeFinished(this.beforeInitFinished.bind(this)),{setLang:u}},r.prototype.beforeInitFinished=function(){return n(this,void 0,void 0,(function(){return e(this,(function(t){switch(t.label){case 0:return[4,l()];case 1:return t.sent(),[2]}}))}))},r}(i),h=new p;export{p as I18nModule,h as module,f as t};
